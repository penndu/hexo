---
title: ServerStatus å¤šæœåŠ¡å™¨äº‘ç›‘æ§
tags:
  - ç›‘æ§
categories:
  - èµ„æºåˆ†äº«
date: 2023-11-02 00:00:00
---

> å»ä¸å›¾åºŠæ•°æ®æ‰˜ç®¡é‡å·²è¶…è¿‡ 23 ä¸‡ï¼Œæœ‰ä¸€äº›å°ä¼™ä¼´åé¦ˆè¯´å¤–é“¾é€Ÿåº¦æ…¢äº†äº›ï¼Œäºæ˜¯æœè€å¸ˆæœ‰å¢åŠ å‡ ä¸ªèŠ‚ç‚¹ã€‚ç”±äºæ˜¯è‡ªå»º CDNï¼Œä¸ºäº†ä¿éšœå¤–é“¾ç¨³å®šï¼Œè®¾ç½®äº†äº‘ç›‘æ§ï¼ŒåŒæ—¶å°†è¯¥å·¥å…·åˆ†äº«ç»™éœ€è¦çš„å°ä¼™ä¼´ä»¬ï¼

<!-- more -->

## å·¥å…·ä»‹ç»

é€šè¿‡ä¸‹æ–¹æˆªå›¾å¯ä»¥çœ‹å‡ºï¼Œå»ä¸å›¾åºŠæ‰˜ç®¡å›¾ç‰‡æ•°è¶…è¿‡äº† 23 ä¸‡ï¼Œæ•°æ®å ç”¨è¶…è¿‡äº† 93Gã€‚æœ‰ä¸€äº›å°ä¼™ä¼´åé¦ˆè¯´å¤–é“¾é€Ÿåº¦æ…¢äº†äº›ï¼Œäºæ˜¯æœè€å¸ˆæœ‰å¢åŠ å‡ ä¸ªèŠ‚ç‚¹ã€‚ç”±äºæ˜¯è‡ªå»º CDNï¼Œä¸ºäº†ä¿éšœå¤–é“¾ç¨³å®šï¼Œè®¾ç½®äº†äº‘ç›‘æ§ï¼ŒServerStatus ä¸­æ–‡ç‰ˆæ˜¯ä¸€ä¸ªé…·ç‚«é«˜é€¼æ ¼çš„äº‘æ¢é’ˆã€æœåŠ¡å™¨äº‘ç›‘æ§ã€å¤šæœåŠ¡å™¨æ¢é’ˆï¼š

![](https://cdn.dusays.com/2023/11/642-1.jpg)

## é…ç½®æ–‡ä»¶

ServerStatus åœ¨å¯ç”¨æœåŠ¡ä¹‹å‰ï¼Œéœ€å…ˆé€šè¿‡é…ç½®æ–‡ä»¶è®¾ç½®ç›‘æ§å¯¹è±¡ï¼Œå°†ä¸‹é¢çš„å†…å®¹æ ¹æ®éœ€æ±‚è°ƒæ•´ï¼Œä¿å­˜ä¸º `serverstatus-config.json`ï¼š

```
{
  "servers":
	[
		{
			"username": "s01",
			"name": "vps-1",
			"type": "kvm",
			"host": "chengdu",
			"location": "ğŸ‡¨ğŸ‡³",
			"password": "USER_DEFAULT_PASSWORD",
			"monthstart": 1
		},
	],
	"watchdog":
	[
	  {
			"name": "æœåŠ¡å™¨è´Ÿè½½é«˜ç›‘æ§ï¼Œæ’é™¤å†…å­˜å¤§äº32Gç‰©ç†æœºï¼ŒåŒæ—¶æ’é™¤ä¿„å‹’å†ˆæœºå™¨",
			"rule": "cpu>90&load_1>4&memory_total<33554432&name!='ä¿„å‹’å†ˆ'",
			"interval": 600,
			"callback": "https://yourSMSurl"
		},
		{
      "name": "æœåŠ¡å™¨å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜ç›‘æ§",
      "rule": "(memory_used/memory_total)*100>90",
      "interval": 600,
      "callback": "https://yourSMSurl"
    },
    {
      "name": "æœåŠ¡å™¨å®•æœºå‘Šè­¦ï¼Œæ’å‡ºä¿„å‹’å†ˆï¼Œæ’é™¤s02",
      "rule": "online4=0&online6=0&name!='ä¿„å‹’å†ˆ'&username!='s02'",
      "interval": 600,
      "callback": "https://yourSMSurl"
    },
		{
      "name": "DDOSå’ŒCCæ”»å‡»ç›‘æ§",
      "rule": "tcp_count>600",
      "interval": 300,
      "callback": "https://yourSMSurl"
    },
		{
			"name": "æœåŠ¡å™¨æœˆå‡ºå£æµé‡999GBå‘Šè­¦",
			"rule": "(network_out-last_network_out)/1024/1024/1024>999",
			"interval": 3600,
			"callback": "https://yourSMSurl"
		},
		{
			"name": "ä½ å¯ä»¥ç»„åˆä»»ä½•å·²çŸ¥å­—æ®µçš„è¡¨è¾¾å¼",
			"rule": "(hdd_used/hdd_total)*100>95",
			"interval": 1800,
			"callback": "https://yourSMSurl"
		}
	]
}
```

æœè€å¸ˆæ”¶é›†äº†å‡ ä¸ªå‚æ•°ä½œç”¨ï¼Œä¾›å°ä¼™ä¼´å‚è€ƒï¼š

| å‚æ•° | ä½œç”¨ |
| - | - |
! rule | å¯è®¾ç½®ä¸ºä»»ä½•å·²çŸ¥å­—æ®µçš„è¡¨è¾¾å¼ |
! interval | æœ€å°é€šçŸ¥é—´éš” |
! callback | å¯è‡ªå®šä¹‰ä¸º POST æ–¹æ³•çš„ URLï¼Œå‘Šè­¦å†…å®¹å°†æ‹¼æ¥å…¶åå¹¶å‘èµ·å›è°ƒ |
! callback Telegram | https://api.telegram.org/bot<Token>/sendMessage?parse_mode=HTML&disable_web_page_preview=true&chat_id=<ID>&text= |
! callback Serveré…± | https://sctapi.ftqq.com/<Token>.send?title=ServerStatus&desp= |
! callback PushDeer | https://api2.pushdeer.com/message/push?pushkey=<Token>&text= |
! callback BasicAuth | https://USER:PASS@URL/api/push?message= |

## éƒ¨ç½²æ–¹æ³•

Server æœåŠ¡ç«¯ï¼Œé¦–å…ˆåœ¨é…ç½®æ–‡ä»¶åŒçº§ç›®å½•æ‰§è¡Œ `mkdir serverstatus-monthtraffic` åˆ›å»ºç›®å½•ï¼Œç„¶åæ‰§è¡Œä¸‹æ–¹å‘½ä»¤å³å¯å¯ç”¨æœåŠ¡ï¼š   

```
docker run -d --restart=always --name=serverstatus -v ~/serverstatus-config.json:/ServerStatus/server/config.json -v ~/serverstatus-monthtraffic:/usr/share/nginx/html/json -p 80:80 -p 35601:35601 cppla/serverstatus:latest
```

Client å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¸æ”¯æŒç”¨ Docker éƒ¨ç½²ï¼Œç›´æ¥ä½¿ç”¨ä¸‹æ–¹å‘½ä»¤å³å¯è‡ªåŠ¨éƒ¨ç½²ï¼š

```
wget --no-check-certificate -qO client-linux.py 'https://raw.githubusercontent.com/penndu/ServerStatus/master/clients/client-linux.py' && nohup python3 client-linux.py SERVER={$SERVER} USER={$USER} PASSWORD={$PASSWORD} > /dev/null 2>&1 &
```

## ä¸åŒä¸»é¢˜

é»˜è®¤ç›‘æ§é¡µé¢å¦‚ä¸‹ï¼Œç‚¹å‡»æœåŠ¡å™¨é¡¹å¯ä»¥æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…å«å†…å­˜ã€ç¡¬ç›˜ã€ç½‘ç»œæƒ…å†µç­‰ç­‰ï¼Œé¡µé¢æ¯ä¸‰ç§’ä¼šè‡ªåŠ¨åˆ·æ–°ï¼š

![](https://cdn.dusays.com/2023/11/642-2.jpg)

è¿™ä¸ªæ˜¯ç”¨æˆ·è‡ªå®šä¹‰æ¨¡æ¿ï¼Œå¦‚éœ€ç”¨è¯¥æ¨¡æ¿ï¼Œéœ€è¦æ‰‹åŠ¨éƒ¨ç½² Server æœåŠ¡ç«¯ï¼Œæ— æ³•ä½¿ç”¨ Docker çš„æ–¹å¼éƒ¨ç½²ï¼š

![](https://cdn.dusays.com/2023/11/642-3.jpg)

è¿™æ¬¾æ˜¯æœè€å¸ˆç›®å‰ç”¨çš„ä¸»é¢˜ã€Œç›®å‰éƒ¨ç½²åœ¨å†…ç½‘ä¸­ï¼Œæš‚æ—¶æ— æ³•å…¬å¸ƒæ¼”ç¤ºé“¾æ¥ã€

![](https://cdn.dusays.com/2023/11/642-4.jpg)
{% endgallery %}