---
title: 云主机的极致优化
tags:
  - 优化
categories:
  - 运维教程
date: 2019-09-07 00:00:00
---

> 之前我们搭建网站，通常会使用虚拟主机的形式，而云主机可比虚拟主机贵上很多，既然咱多花钱，当然要让云主机发挥极致的性能。今天就来聊聊，如何配置能让你的云主机跑吐血！写在最前：以下涉及到的服务，墙裂推荐使用编译安装！

<!-- more -->

## 环境选择

首先是网站环境的搭建，Nginx 和 Apache 随便选，只是版本尽量不要选测试版，最好选一个稳定版，毕竟新的功能你用不上，出现问题还要折腾，最主要是新版本的帮助文件很少。

接下来安装 PHP，PHP 的版本越高越好，但是前提需要你的网站程序支持，而且根据一个前辈建议，最好是使用偶数版，例如 5.6/7.0/7.2 这种的。

再者就是脚本缓存，XCache/OPcache 选一项安装，PHP5.2-5.4 建议使用 XCache，PHP5.5 以上建议使用 OPcache。

如果需要内容缓存，建议先考虑 Redis，再 Memcached，后 Memcache「PS 需程序支持，PPS 差个 d 差距很大」注意：内容缓存加上脚本缓存，都只安装一个，不要安装多个！

## 扩展推荐

如果程序支持，尽量使用 ImageMagick 代替 PHP 自带 GD 以提升性能；如果程序支持，尽量安装 FileInfo/Exif 扩展以提升站点性能和安全性；如程序不需要，尽量不要安装 ZendGuardLoader/ionCube 等解密扩展；如程序不需要 PATH_INFO 请把它关闭；PHP 并发值设置建议：

| CPU和内存 | 单个站点 | 多个站点 |
| - | - | - |
| 1H/512M | 20-30 | 10-20 |
| 1H/1G | 30-50 | 20-30 |
| 1H/2G | 50-80 | 30-50 |
| 2H/4G | 60-100 | 30-50 |
| 4H/8G | 100-200 | 30-80 |
| 8H/16G+ | 100-300 | 100-150 |

## 版本建议

MySQL 数据库版本建议：

| CPU和内存 | 数据库的版本 |
| - | - |
| 1H/512M | MySQL5.1 |
| 1H/1G | MySQL5.1/5.5 |
| 1H/2G | MySQL5.1/5.5 |
| 2H/4G | MySQL5.5/5.6 |
| 4H/8G+ | MySQL5.5/5.6/5.7 |

## Swap 推荐值

为了系统稳定，墙裂建议大家添加个 Swap，这里分享一下 Swap 推荐值：

| 物理内存 | Swap推荐值 |
| - | - |
| 512M | 1024M |
| 1G | 1500M |
| 2G | 2048M |
| 4G+ | 4096M |
