---
title: 杜老师说网站架构
tags:
  - 架构
categories:
  - 运维教程
date: 2021-04-22 00:00:00
---

> 最近调整了杜老师说的网站架构，保障平稳运行的同时降低运营的成本，此文做记录的同时也向大家分享一下目前架构，如有建议欢迎在评论区留言！

<!-- more -->

## 网站架构

杜老师说网站架构：

{% gallery %}
![](https://cdn.dusays.com/2021/04/334-1.jpg)
{% endgallery %}

## 数据走向

访客通过互联网将请求发送至域名解析服务器，DNS 服务器为 Cloudflare「以下简称为 CF」仅作域名解析，并未开启缓存功能。

CF 将域名指向 CDN 地址，CDN 优先查找对应的缓存数据，如未找到缓存数据，则请求 OSS 中保存的网站数据。

OSS 的网站数据由 ECS 生成，ECS 运行 Hexo，生成的网站源码通过 API 传输至 OSS。

当访客评论时，评论数据发送给 CDN，并经由北京 ECS 存至香港 ECS 数据库。

## 架构优点

CDN 可以隐藏后端服务器的真实 IP，保护 ECS 不被 DDoS，同时 CDN 的缓存功能可以降低后端负载，且降低 OSS 因流量产生的费用。

ECS 通过内网连接 OSS，提升传输速率同时，降低因流量产生的费用「内网流量免费」

通过 OSS 静态网站功能可以降低 ECS 负载，且外网流量费用低于 ECS「ECS 带宽按流量付费」

多个节点数据互不影响，保障高效运行同时降低因数据丢失产生的影响。

## 架构缺点

两台 ECS 服务器不在同一地域，跨域访问会影响传输的速率，且会产生额外费用。

CDN 缓存会导致网站内容更新延迟，部分内容更新后需手动刷新缓存数据才可正常访问。
