---
title: 磁盘阵列搭建
tags:
  - 磁盘
categories:
  - 运维教程
date: 2019-12-02 00:00:00
---

> RAID 全称 Redundant Array of Inexpensive Disks，廉价冗余磁盘阵列，通过多块磁盘组成一种模式，来提高吞吐量和可靠性。今天杜老师就为大家讲一下 Linux 系统软件磁盘阵列的搭建。

<!-- more -->

## 磁盘阵列功能

1. 提高磁盘读取效率；

2. 提供容错功能。

## 磁盘阵列等级

等级列表如下：

| 等级 | 描述 |
| - | - |
| RAID0 | 由两块或两块以上硬盘组成，数据分成两份同时写入读取两块硬盘，所以优点就是速度很快，缺点就是数据不太安全，如果一块硬盘坏了，整个阵列的数据都毁了，总容量为所有磁盘容量的和 |
| RAID1 | 由两块或两块以上硬盘组成，数据在向一块硬盘写入读取同时向另一块硬盘同样操作，这样的结果是一个数据有了两份，更安全了。缺点就是资源浪费，成本较大，总容量为一块硬盘容量 |
| RAID10 | 由四块或以上硬盘组成，首先两块硬盘组建成 RAID1，然后两块 RAID1 再组建成 RAID0。它具备了 RAID0 的高速，以及 RAID1 的安全，目前主流 Web 服务器都用这种阵列 |
| RAID5 | 由三块或以上硬盘组成，通过奇偶算法，将数据分发到三块硬盘上面，当一块硬盘坏掉时，可以通过算法，从另外两块硬盘上将数据算出来。总容量为磁盘容量减一 |

## 磁盘阵列命令

创建命令 `mdadm -C /dev/md5 -l 5 -n 3 -x 1 /dev/sdb{1,2,3,5}` 的解释如下：

| 选项 | 作用 |
| - | - |
| -C /dev/md5 | 创建一个以 md5 为命名的磁盘阵列 |
| -l 5 | 磁盘阵列等级为 5 |
| -n 3 | 使用 3 块作为阵列磁盘 |
| -x 1 | 使用 1 块作为备用磁盘 |
| /dev/sdb{1,2,3,5} | 分别调用 4 个分区组建磁盘阵列 |

查询命令列表如下：

| 命令 | 作用 |
| - | - |
| cat /proc/mdstat | 查询磁盘阵列运行状态 |
| mdadm -D /dev/md5 | 查询名为 md5 的磁盘阵列详细信息 |

模拟错误命令 `mdadm /dev/md5 -f /dev/sdb1` 的解释如下：

| 命令 | 作用 |
| - | - |
| -f /dev/sdb1 | 将/dev/sdb1 标记为错误的状态 |

移除磁盘命令 `mdadm /dev/md5 -r /dev/sdb1` 的解释如下：

| 命令 | 作用 |
| - | - |
| -r /dev/sdb1 | 从磁盘阵列移除/dev/sdb1 |

增加磁盘命令 `mdadm /dev/md5 -a /dev/sdb1` 的解释如下：

| 命令 | 作用 |
| - | - |
| -a /dev/sdb1 | 将/dev/sdb1 添加到磁盘阵列中 |

停用磁盘阵列命令 `mdadm -S /dev/md5` 的解释如下:

| 命令 | 作用 |
| - | - |
| -S /dev/md5 | 停用磁盘阵列 |

## 阵列搭建演示

点击播放：

[![asciicast](https://asciinema.org/a/281563.svg)](https://asciinema.org/a/281563)
