---
title: NFS 的服务详解「下篇」
tags:
  - 服务
categories:
  - 运维教程
date: 2019-07-24 00:00:00
---

> NFS 即网络文件系统，是 FreeBSD 支持文件系统中的一种，它允许网络中的计算机之间共享资源。在 NFS 的应用中，本地 NFS 的客户端应用可以透明地读写位于远端 NFS 服务器上的文件，就像访问本地文件一样。

<!-- more -->

## 指定共享对象

我们需要在配置文件中指定共享对象，上篇文章中我们指定了客户端的地址，除了这种单主机指向外，还有如下形式：

| 对象 | 形式 | 备注 |
| - | - | - |
| 单机 | 192.168.1.1 | 任何使用该 IP 的主机都可连接服务器 |
| 网段 | 192.168.1.0/24 | 处在该网段的主机可连接服务器 |
| 网址 | nfs.dusays.com | 该域名可解析的 IP 对应主机可连接服务器 |
| 所有 | * | 所有设备都可以连接服务器 |

## 权限参数设置

NFS 服务端除了只读、读写权限之外，还有很多权限可以设置，在这里与大家分享：

| 参数命令 | 参数用途 |
| - | - |
| ro | 只读 |
| rw | 读写 |
| sync | 请求或写入数据时，数据同步写到内存与硬盘中将数据同步写入内存缓冲区与磁盘中，效率较低，但可保证数据的一致性 |
| async | 异步，优先将数据保存到内存，然后再写入到硬盘；这样效率更高，但可能会丢失数据 |
| root_squash | 当 NFS 客户端以 root 访问时，映射为 NFS 服务器的匿名用户 |
| no_root_squash | 当 NFS 客户端以 root 访问时，映射为 NFS 服务器的 root 管理员 |
| all_squash | 无论 NFS 客户端使用什么账户访问，均映射为 NFS 的匿名用户 |
| anonuid=UID | 指定匿名用户身份，指定用户必须存在 | 
| anongid=GID | 指定匿名群组身份，指定群组必须存在 |

## 服务查看命令

查看 NFS 服务器导出的各文件系统：

```
showmount -e ServerIP
```

查看 NFS 服务器所有被挂载的文件系统及其挂载的客户端对应关系列表：

```
showmount -a ServerIP
```

## 实现开机挂载

```
ServerIP:/PATH /LocalDIR nfs defaults 0 0
```

注意：将上面代码添加到/etc/fstab 文件中，即可实现开启自动挂载。