---
title: 通过 SRV 解析无需端口连接我的世界服务器
tags:
  - 解析
categories:
  - 运维教程
date: 2021-09-16 00:00:00
---

> SRV 记录是 DNS 服务器的数据库中支持的一种资源记录类型，它记录了哪台计算机提供哪个服务这么一个简单的信息。一般是为 Microsoft 的活动目录设置时的应用。

<!-- more -->

## 需求背景

杜老师搭建我的世界服务器已经有一个多月了，有很多小伙伴加入一起游戏，被问到最多的问题就是：游戏的端口是多少？

我们的服务器是同他人合租，所以无法使用默认端口，连接时需输入端口才可进入游戏，无形中增加了记忆成本。

如何免端口进入游戏呢？杜老师之前有写过一篇文章《[80 端口重定向三种解决方案](https://dusays.com/366/)》，可以通过反向代理、端口转发等方式解决该问题，但需要在用户和服务器间新增一台中间件，这将会增加游戏的延迟。

最终杜老师了解到，可以通过 DNS 解析中的 SRV 功能，实现不需要端口连接我的世界服务器。

## 解析设置

这里已 Cloudflare 为例，演示如何添加 SRV 解析项。参考如图，其中类型选 `SRV`，名称则为二级域名，如需要通过 `mc.dusays.com` 连接游戏，则名称输入 `mc`，服务可自定义，因为我们要连接我的世界服务器，所以填写了`_minecraft`，协议根据实际情况选择 `TCP` 或者 `UDP`，`TTL` 可自动，优先级和权重根据需求填写，范围是 `0-65535`，数字越小优先级和权重越高，端口则写服务器的端口，最后在目标中填写服务器的地址：

{% gallery %}
![](https://cdn.dusays.com/2021/09/383-1.jpg)
{% endgallery %}

## 设置效果

设置好解析后保存即可，等待解析同步 DNS 缓存服务器，2 小时内即可同步完成「往往等几分钟即可」进入游戏后添加服务器试试，效果如下动画：

{% gallery %}
![](https://cdn.dusays.com/2021/09/383-1.gif)
{% endgallery %}

## 解析查询

这里做个技术扩展，我们可以通过 nslookup 命令查看 SRV 解析，完整的命令参考 `nslookup -q=srv _minecraft._tcp.mc.dusays.com`，执行效果如图：

{% gallery %}
![](https://cdn.dusays.com/2021/09/383-2.jpg)
{% endgallery %}
